<div class="image-upload-container">
  <label class="upload-label">{{ label }}</label>

  <!-- Preview da Imagem -->
  @if (previewUrl()) {
  <div class="preview-container" [class.aspect-16-9]="aspectRatio === '16:9'"
    [class.aspect-1-1]="aspectRatio === '1:1'" [class.aspect-4-3]="aspectRatio === '4:3'">
    <img [src]="previewUrl()" [alt]="label" class="preview-image" />

    <!-- Overlay com ações -->
    <div class="preview-overlay">
      <button pButton icon="pi pi-trash" class="p-button-rounded p-button-danger remove-button"
        (click)="onRemoveImage()" [disabled]="isUploading()"></button>
      <button pButton icon="pi pi-refresh" class="p-button-rounded p-button-secondary change-button"
        (click)="triggerFileInput()" [disabled]="isUploading()"></button>
    </div>

    <!-- Barra de progresso durante upload -->
    @if (isUploading()) {
    <div class="progress-overlay">
      <p-progressBar [value]="uploadProgress()" [showValue]="true"></p-progressBar>
      <span class="progress-text">Enviando... {{ uploadProgress() }}%</span>
    </div>
    }
  </div>
  } @else {
  <!-- Área de Upload (Drag & Drop) -->
  <div class="upload-area" [class.drag-over]="isDragOver()" [class.aspect-16-9]="aspectRatio === '16:9'"
    [class.aspect-1-1]="aspectRatio === '1:1'" [class.aspect-4-3]="aspectRatio === '4:3'"
    (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)" (drop)="onDrop($event)"
    (click)="triggerFileInput()">
    <i class="pi pi-cloud-upload upload-icon"></i>
    <p class="upload-text">Arraste uma imagem ou clique para selecionar</p>
    <p class="upload-hint">JPG, PNG ou WebP (máx. 5MB)</p>
  </div>
  }

  <!-- Input oculto -->
  <input type="file" [id]="'file-input-' + uploadType" accept="image/jpeg,image/jpg,image/png,image/webp"
    (change)="onSelectFile($event)" style="display: none" />

  <!-- Mensagem de erro -->
  @if (error()) {
  <div class="error-message">
    <i class="pi pi-exclamation-triangle"></i>
    <span>{{ error() }}</span>
  </div>
  }
</div>
