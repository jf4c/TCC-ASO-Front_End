<p-dialog
  [visible]="visible()"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [closable]="true"
  [styleClass]="'chapter-dialog'"
  [header]="dialogTitle()"
  (onHide)="handleCancel()"
>
  <div class="dialog-content">
    <div class="form-field">
      <label for="chapterTitle">
        Título do Capítulo
        <span class="required">*</span>
      </label>
      <aso-input
        id="chapterTitle"
        [(ngModel)]="chapterTitle"
        placeholder="Ex: O Encontro na Taverna"
        class="w-full"
        required
      ></aso-input>
      <div class="char-counter" [class.warning]="getRemainingChars() < 20">
        {{ getRemainingChars() }} caracteres restantes
      </div>
      <div class="field-error" *ngIf="showValidation() && !isValid()">
        <i class="pi pi-exclamation-triangle"></i>
        <ng-container *ngIf="chapterTitle().trim().length === 0">
          O título é obrigatório
        </ng-container>
        <ng-container *ngIf="chapterTitle().trim().length > 0">
          O título não pode ter mais de {{ maxTitleLength }} caracteres
        </ng-container>
      </div>
    </div>

    <div class="form-field">
      <label for="chapterContent">Conteúdo do Capítulo</label>
      <aso-textarea
        id="chapterContent"
        [(ngModel)]="chapterContent"
        placeholder="Descreva os eventos, diálogos e acontecimentos deste capítulo da aventura..."
        class="w-full"
      ></aso-textarea>
      <div class="field-hint">
        Conte a história deste momento da aventura (opcional)
      </div>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <div class="footer-info">
        <i class="pi pi-info-circle"></i>
        Campos com * são obrigatórios
      </div>
      <div class="footer-actions">
        <aso-button
          label="Cancelar"
          icon="pi pi-times"
          severity="secondary"
          (eventClick)="handleCancel()"
        ></aso-button>
        <aso-button
          [label]="
            data()?.isEditing ? 'Salvar Alterações' : 'Criar Capítulo'
          "
          icon="pi pi-check"
          severity="success"
          (eventClick)="handleSave()"
        ></aso-button>
      </div>
    </div>
  </ng-template>
</p-dialog>
